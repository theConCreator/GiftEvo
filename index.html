<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Web App Game</title>
    <style>
        /* --- 1. –ë–∞–∑–æ–≤—ã–µ –°—Ç–∏–ª–∏ –∏ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; 
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }

        #game-container {
            width: 100%;
            max-width: 600px;
            height: calc(100vh - 120px); 
            overflow-y: scroll; 
            background-color: #2c2c2c; /* –§–æ–Ω —à–∞—Ö—Ç—ã */
            border-left: 2px solid #555;
            border-right: 2px solid #555;
            position: relative; 
            box-sizing: border-box;
            -webkit-overflow-scrolling: touch; 
        }

        /* --- 2. –°—Ç–∏–ª—å –ê—Ä–µ–Ω—ã –∏ –ë–ª–æ–∫–æ–≤ (50px) --- */
        #arena {
            display: grid;
            grid-template-columns: 1fr repeat(6, 50px) 1fr; 
            grid-auto-rows: 50px; 
            min-height: 100%; 
        }

        /* –ë–æ–∫–æ–≤—ã–µ —Å—Ç–µ–Ω—ã */
        .wall {
            background-color: #333;
            border: 1px solid #444;
            opacity: 0.9;
        }
        .wall.left { grid-column: 1 / 2; }
        .wall.right { grid-column: 8 / 9; }

        .block {
            width: 50px; 
            height: 50px; 
            border: 1px solid black;
            box-sizing: border-box;
            text-align: center;
            line-height: 48px; 
            font-size: 10px;
            font-weight: bold;
            color: #eee;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.4);
            transition: opacity 0.2s;
        }
        
        /* 7 –¢–ò–ü–û–í –ë–õ–û–ö–û–í */
        .block-dirt { background-color: #8b572a; border-color: #633e1e; }
        .block-stone { background-color: #808080; border-color: #5d5d5d; }
        .block-coal { background-color: #36454F; border-color: #2b363c; } 
        .block-iron { background-color: #C0C0C0; border-color: #a0a0a0; } 
        .block-gold { background-color: #FFD700; border-color: #ccac00; color: #1a1a1a; } 
        .block-diamond { background-color: #4682b4; border-color: #316089; box-shadow: inset 0 0 10px rgba(0, 255, 255, 0.7); } 
        .block-emerald { background-color: #50C878; border-color: #3a9757; } 
        
        .mined {
            opacity: 0 !important; 
            pointer-events: none; 
        }

        /* --- 3. –°—Ç–∏–ª—å –ö–∏—Ä–∫–∏ –∏ –≠—Ñ—Ñ–µ–∫—Ç—ã --- */
        #pickaxe {
            width: 40px; 
            height: 40px; 
            border-radius: 5px;
            position: absolute; 
            top: -100px; 
            left: 50%;
            transform: translate(-50%, 0); 
            box-shadow: 0 0 10px rgba(255, 255, 0, 0.5);
            display: none; 
            text-align: center;
            line-height: 40px;
            font-size: 20px; 
            z-index: 10;
            transition: box-shadow 0.1s, transform 0.05s;
        }

        .pickaxe-hit-glow {
            /* –≠—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—á–µ–Ω–∏—è –ø—Ä–∏ —É–¥–∞—Ä–µ */
            box-shadow: 0 0 15px 5px rgba(255, 255, 255, 0.8), 0 0 10px rgba(255, 255, 0, 0.5);
        }

        /* 5 –¢–ò–ü–û–í –ö–ò–†–û–ö */
        .pickaxe-wood { background-color: #a0522d; }
        .pickaxe-stone { background-color: #999; }
        .pickaxe-iron { background-color: #C0C0C0; }
        .pickaxe-diamond { background-color: #00bcd4; box-shadow: 0 0 10px rgba(0, 255, 255, 0.7); }
        .pickaxe-netherite { background-color: #36454F; box-shadow: 0 0 15px rgba(255, 0, 0, 0.9); }
        
        /* --- 4. –≠–ª–µ–º–µ–Ω—Ç—ã –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è --- */
        #controls {
            padding: 10px;
            width: 100%;
            max-width: 600px;
            background-color: #2b2b2b;
            text-align: center;
            position: fixed; 
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.5);
            box-sizing: border-box;
            z-index: 20;
        }

        .pickaxe-button {
            padding: 8px 12px; 
            margin: 5px 2px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: background-color 0.2s, transform 0.1s;
        }
        .pickaxe-button:active {
            transform: scale(0.98);
        }

        .pickaxe-button[data-type="wood"] { background-color: #9c5e3d; }
        .pickaxe-button[data-type="stone"] { background-color: #999; }
        .pickaxe-button[data-type="iron"] { background-color: #6a6a6a; }
        .pickaxe-button[data-type="diamond"] { background-color: #00bcd4; color: #1a1a1a; }
        .pickaxe-button[data-type="netherite"] { background-color: #36454F; color: #FFD700; border: 1px solid #FFD700; }
        
        #message {
            margin-top: 5px;
            min-height: 20px;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="pickaxe">‚õèÔ∏è</div> 
        
        <div id="arena">
            </div>
    </div>

    <div id="controls">
        <h3>üí∞ –ë–∞–ª–∞–Ω—Å: <span id="balance">10000</span></h3>
        <p>–ö—É–ø–∏—Ç–µ –∫–∏—Ä–∫—É:</p>
        <button class="pickaxe-button" data-type="wood" data-price="100">–î–µ—Ä–µ–≤–æ (100)</button>
        <button class="pickaxe-button" data-type="stone" data-price="300">–ö–∞–º–µ–Ω—å (300)</button>
        <button class="pickaxe-button" data-type="iron" data-price="800">–ñ–µ–ª–µ–∑–æ (800)</button>
        <button class="pickaxe-button" data-type="diamond" data-price="2500">–ê–ª–º–∞–∑ (2500)</button>
        <button class="pickaxe-button" data-type="netherite" data-price="5000">–ù–µ–∑–µ—Ä–∏—Ç (5000)</button>
        <p id="message">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∏—Ä–∫—É, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!</p>
    </div>
    
    <script>
        // --- 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã ---
        const Telegram = window.Telegram ? window.Telegram.WebApp : null;
        if (Telegram) Telegram.ready();
        
        const ARENA_WIDTH_BLOCKS = 6;
        const BLOCK_SIZE_PX = 50; 
        const PICKAXE_SIZE_PX = 40; 
        const WALL_WIDTH_PX = 30; 
        const GAME_WIDTH_PX = (ARENA_WIDTH_BLOCKS * BLOCK_SIZE_PX) + (2 * WALL_WIDTH_PX);

        const arena = document.getElementById('arena');
        const pickaxeElement = document.getElementById('pickaxe');
        const balanceElement = document.getElementById('balance');
        const messageElement = document.getElementById('message');
        const gameContainer = document.getElementById('game-container');
        
        // –§–∏–∑–∏–∫–∞
        const GRAVITY = 0.98; 
        const INITIAL_SPEED_MAX = 12; 
        const WALL_BOUNCE = 0.7; 
        const BLOCK_BOUNCE_TARGET_VELOCITY = -10; // –¶–ï–õ–ï–í–ê–Ø –°–ö–û–†–û–°–¢–¨ –û–¢–°–ö–û–ö–ê
        
        // –ö–∞–º–µ—Ä–∞ –∏ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
        const CAMERA_SMOOTHNESS = 0.04; 
        const CAMERA_OFFSET_Y = 0.35; 
        const ROWS_TO_GENERATE_AT_ONCE = 30; 
        const LOAD_TRIGGER_DISTANCE = 750; 
        const EMPTY_START_ROWS = 20; // –£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
        const INITIAL_MINING_ROWS = 30; 
        
        let playerBalance = 10000; 
        let activePickaxe = null; 
        let lastTime = 0;
        let totalRows = 0; 
        
        // --- 2. –°–í–û–ô–°–¢–í–ê –ö–ò–†–û–ö –ò –ë–õ–û–ö–û–í ---

        const PICKAXE_PROPERTIES = {
            wood: { durability: 0.30, strength: 1, name: '–î–µ—Ä–µ–≤—è–Ω–Ω–∞—è' }, 
            stone: { durability: 0.25, strength: 2, name: '–ö–∞–º–µ–Ω–Ω–∞—è' }, 
            iron: { durability: 0.15, strength: 4, name: '–ñ–µ–ª–µ–∑–Ω–∞—è' },  
            diamond: { durability: 0.05, strength: 8, name: '–ê–ª–º–∞–∑–Ω–∞—è' },
            netherite: { durability: 0.00, strength: 15, name: '–ù–µ–∑–µ—Ä–∏—Ç–æ–≤–∞—è' }
        };

        const BLOCK_PROPERTIES = {
            dirt: { toughness: 1, reward: 5, name: '–ì—Ä—è–∑—å' },
            stone: { toughness: 2, reward: 10, name: '–ö–∞–º–µ–Ω—å' },
            coal: { toughness: 4, reward: 30, name: '–£–≥–æ–ª—å' },
            iron: { toughness: 6, reward: 80, name: '–ñ–µ–ª–µ–∑–æ' },
            gold: { toughness: 8, reward: 150, name: '–ó–æ–ª–æ—Ç–æ' },
            diamond: { toughness: 12, reward: 500, name: '–ê–ª–º–∞–∑' },
            emerald: { toughness: 15, reward: 1000, name: '–ò–∑—É–º—Ä—É–¥' },
            empty: { toughness: 0, reward: 0, name: '–ü—É—Å—Ç–æ—Ç–∞' } // –î–ª—è –ø—É—Å—Ç—ã—Ö —Ä—è–¥–æ–≤
        };

        // --- 3. –ö–ª–∞—Å—Å –ö–∏—Ä–∫–∏ (–§–∏–∑–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å) ---
        class Pickaxe {
            constructor(type) {
                this.type = type;
                this.stats = PICKAXE_PROPERTIES[type];
                this.element = pickaxeElement;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                this.x = WALL_WIDTH_PX + (Math.random() * (GAME_WIDTH_PX - 2 * WALL_WIDTH_PX - PICKAXE_SIZE_PX));
                this.y = gameContainer.scrollTop - PICKAXE_SIZE_PX; 
                this.vx = (Math.random() * INITIAL_SPEED_MAX * 2) - INITIAL_SPEED_MAX; 
                this.vy = -(Math.random() * INITIAL_SPEED_MAX / 2); 
                this.rotation = 0; 
                this.vRotation = (Math.random() * 0.4) - 0.2; 
                this.isBroken = false;
                
                this.element.className = `pickaxe-placeholder pickaxe-${type}`;
                this.element.style.display = 'block';
                this.updateDOM();
            }

            updateDOM() {
                this.element.style.left = `${this.x}px`;
                this.element.style.top = `${this.y}px`;
                this.element.style.transform = `translate(-50%, 0) rotate(${this.rotation}deg)`;
            }

            update(deltaTime) {
                if (this.isBroken) return false;
                
                this.vy += GRAVITY * deltaTime; 
                this.x += this.vx * deltaTime;
                this.y += this.vy * deltaTime;
                this.rotation += this.vRotation * deltaTime * 5; 
                this.vRotation *= 0.999; 
                
                // 1. –ö–æ–ª–ª–∏–∑–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏
                const minX = WALL_WIDTH_PX;
                const maxX = GAME_WIDTH_PX - WALL_WIDTH_PX - PICKAXE_SIZE_PX;

                if (this.x < minX || this.x > maxX) {
                    this.x = this.x < minX ? minX : maxX;
                    this.vx *= -WALL_BOUNCE; 
                    this.vRotation = (Math.random() * 0.4) - 0.2; 
                }
                
                this.vx *= 0.995; 
                
                // 2. –ö–æ–ª–ª–∏–∑–∏—è —Å –±–ª–æ–∫–∞–º–∏ (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏–π)
                if (this.y + PICKAXE_SIZE_PX > 0) { 
                    const blockHit = this.checkCollisionWithBlocks();
                    if (blockHit) {
                        // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–¥ –æ—Ç—Å–∫–æ–∫–æ–º
                        this.y = (parseInt(blockHit.dataset.row) * BLOCK_SIZE_PX) - PICKAXE_SIZE_PX;
                        this.handleHit(blockHit);
                    }
                }
                
                this.updateDOM();
                
                if (this.y > gameContainer.scrollTop + gameContainer.clientHeight + 300) {
                    return false;
                }
                
                return true; 
            }
            
            checkCollisionWithBlocks() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–∏–∂–Ω—é—é —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É –∫–∏—Ä–∫–∏
                const relativeX = this.x - WALL_WIDTH_PX + (PICKAXE_SIZE_PX / 2);
                const colIndex = Math.floor(relativeX / BLOCK_SIZE_PX);
                const rowIndex = Math.floor((this.y + PICKAXE_SIZE_PX) / BLOCK_SIZE_PX); 

                const blockElement = arena.querySelector(`[data-row="${rowIndex}"][data-col="${colIndex}"]`);

                if (blockElement && !blockElement.classList.contains('mined') && blockElement.dataset.type !== 'empty') {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ DOM-–ø–æ–∑–∏—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —Ç.–∫. y –≤ this.y —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ
                    const blockYStart = rowIndex * BLOCK_SIZE_PX; 
                    
                    if (this.y + PICKAXE_SIZE_PX >= blockYStart) {
                         return blockElement;
                    }
                }
                return null;
            }

            handleHit(blockElement) {
                const blockType = blockElement.dataset.type;
                const blockStats = BLOCK_PROPERTIES[blockType];

                // 1. –†–∞—Å—á–µ—Ç –ø–æ–ª–æ–º–∫–∏ (—à–∞–Ω—Å, —á—Ç–æ –∫–∏—Ä–∫–∞ —Å–ª–æ–º–∞–µ—Ç—Å—è)
                if (Math.random() < this.stats.durability) {
                    this.isBroken = true;
                    messageElement.textContent += ` üíî ${this.stats.name} —Å–ª–æ–º–∞–ª–∞—Å—å!`;
                }

                // 2. –†–∞—Å—á–µ—Ç –¥–æ–±—ã—á–∏ (—à–∞–Ω—Å, —á—Ç–æ –±–ª–æ–∫ —Å–ª–æ–º–∞–µ—Ç—Å—è)
                const hitPower = this.stats.strength; 
                const toughness = blockStats.toughness; 
                const miningChance = hitPower / toughness; 
                
                if (Math.random() < miningChance * 0.2) { 
                    blockElement.classList.add('mined');
                    const reward = blockStats.reward;
                    playerBalance += reward;
                    balanceElement.textContent = playerBalance;
                    messageElement.textContent = `‚úÖ –°–õ–û–ú–ê–ù–û! +${reward} (${blockStats.name})`;
                } else {
                    messageElement.textContent = `üí• –ö–∏—Ä–∫–∞ —É–¥–∞—Ä–∏–ª–∞ ${blockStats.name}. –ü—Ä–æ—á–Ω–æ—Å—Ç—å: ${toughness}.`;
                }
                
                // 3. –û—Ç—Å–∫–æ–∫ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ü–µ–ª–µ–≤–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ—Ç–µ—Ä—å)
                this.vy = BLOCK_BOUNCE_TARGET_VELOCITY; 
                this.vx *= 0.9; 
                this.vRotation = (Math.random() * 0.8) - 0.4; 
                
                // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
                this.element.classList.add('pickaxe-hit-glow');
                setTimeout(() => this.element.classList.remove('pickaxe-hit-glow'), 100);
            }
        }
        
        // --- 4. –ò–≥—Ä–æ–≤–æ–π –¶–∏–∫–ª, –ö–∞–º–µ—Ä–∞ –∏ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ---

        function smoothCameraFollow() {
            if (!activePickaxe) return;

            const targetY = activePickaxe.y;
            const containerHeight = gameContainer.clientHeight;
            
            const targetScrollTop = targetY - (containerHeight * CAMERA_OFFSET_Y);
            
            const currentScrollTop = gameContainer.scrollTop;
            const delta = targetScrollTop - currentScrollTop;
            
            const newScrollTop = currentScrollTop + (delta * CAMERA_SMOOTHNESS);
            
            gameContainer.scrollTop = newScrollTop;
        }

        function checkAndGenerateNewRows() {
            const arenaHeight = totalRows * BLOCK_SIZE_PX;
            const scrollBottom = gameContainer.scrollTop + gameContainer.clientHeight;
            
            if (scrollBottom + LOAD_TRIGGER_DISTANCE > arenaHeight) {
                generateRows(totalRows, ROWS_TO_GENERATE_AT_ONCE);
                messageElement.textContent = `–ì–ª—É–±–∏–Ω–∞: ${totalRows - EMPTY_START_ROWS}. –ó–∞–≥—Ä—É–∂–µ–Ω–æ 30 –Ω–æ–≤—ã—Ö —Ä—è–¥–æ–≤.`;
            }
        }
        
        function gameLoop(currentTime) {
            const deltaTime = (currentTime - lastTime) / 16.67; 
            lastTime = currentTime;
            
            if (activePickaxe) {
                const isActive = activePickaxe.update(Math.min(deltaTime, 3)); 
                smoothCameraFollow(); 
                
                if (!isActive || activePickaxe.isBroken) {
                     activePickaxe = null;
                     pickaxeElement.style.display = 'none';
                     if (!activePickaxe.isBroken) {
                        messageElement.textContent = "–ö–∏—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞ —Å–≤–æ–π –ø–æ–ª—ë—Ç. –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é.";
                     }
                }
            }

            checkAndGenerateNewRows(); 
            
            requestAnimationFrame(gameLoop);
        }

        // –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ù–î–û–ú–ù–ê–Ø –ì–ï–ù–ï–†–ê–¶–ò–Ø (–°–õ–£–ß–ê–ô–ù–´–ï –ë–õ–û–ö–ò)
        function getBlockTypeByDepth(row) {
             const depth = row - EMPTY_START_ROWS;
             if (depth < 0) return 'empty';
             
             // –®–∞–Ω—Å—ã –ø–æ—è–≤–ª–µ–Ω–∏—è —Ä—É–¥ (—Å—É–º–º–∞—Ä–Ω—ã–π —à–∞–Ω—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å <= 1.0)
             let chances = {};
             
             if (depth < 10) { // –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å
                 chances = { dirt: 0.9, stone: 0.1 };
             } else if (depth < 30) { 
                 chances = { stone: 0.8, coal: 0.15, dirt: 0.05 };
             } else if (depth < 60) {
                 chances = { stone: 0.7, iron: 0.15, coal: 0.1, gold: 0.05 };
             } else { // –ì–ª—É–±–æ–∫–æ (–±–æ–ª—å—à–µ 60)
                 chances = { stone: 0.6, iron: 0.1, gold: 0.08, diamond: 0.05, emerald: 0.02, coal: 0.15 };
             }
             
             // –ï—Å–ª–∏ —à–∞–Ω—Å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, —ç—Ç–æ "–ø—É—Å—Ç–æ–π" –±–ª–æ–∫ (—Ñ–æ–Ω —à–∞—Ö—Ç—ã)
             const rand = Math.random();
             let cumulativeChance = 0;
             
             for (const type in chances) {
                 cumulativeChance += chances[type];
                 if (rand < cumulativeChance) {
                     return type;
                 }
             }
             return 'empty'; // –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –±—É–¥–µ—Ç "–ø—É—Å—Ç–æ—Ç–æ–π" (—Ñ–æ–Ω–æ–º)
        }

        function generateRows(startRow, count) {
            for (let r = startRow; r < startRow + count; r++) {
                
                const wallLeft = document.createElement('div');
                wallLeft.className = 'wall left';
                arena.appendChild(wallLeft);
                
                for (let c = 0; c < ARENA_WIDTH_BLOCKS; c++) {
                    const blockType = getBlockTypeByDepth(r); // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞
                    
                    const block = document.createElement('div');
                    
                    block.dataset.row = r;
                    block.dataset.col = c;
                    block.dataset.type = blockType; 
                    
                    if (blockType === 'empty') {
                        // –ü—É—Å—Ç–æ—Ç–∞ - –ø—Ä–æ—Å—Ç–æ –Ω–µ–≤–∏–¥–∏–º—ã–π –±–ª–æ–∫ (–∏–º–∏—Ç–∞—Ü–∏—è —Ñ–æ–Ω–∞)
                        block.className = 'block mined'; 
                    } else {
                        block.className = `block block-${blockType}`;
                        block.textContent = blockType.toUpperCase().substring(0, 2); // –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç
                    }
                    
                    arena.appendChild(block);
                }
                
                const wallRight = document.createElement('div');
                wallRight.className = 'wall right';
                arena.appendChild(wallRight);
            }
            totalRows += count;
        }
        
        function generateInitialArena(emptyRows, miningRows) {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–Ω–∞—á–∞–ª–∞ –ø—É—Å—Ç—ã–µ —Ä—è–¥—ã
            generateRows(0, emptyRows); 
            // –ó–∞—Ç–µ–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä—è–¥—ã —Å –±–ª–æ–∫–∞–º–∏
            generateRows(emptyRows, miningRows); 

            // –°–º–µ—â–∞–µ–º –∫–∞–º–µ—Ä—É –Ω–µ–º–Ω–æ–≥–æ –≤–Ω–∏–∑, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –Ω–∞—á–∞–ª–æ –±–ª–æ–∫–æ–≤
            gameContainer.scrollTop = (emptyRows - 5) * BLOCK_SIZE_PX; 
        }
        
        // --- 5. –õ–æ–≥–∏–∫–∞ –ö–Ω–æ–ø–æ–∫ –∏ –ó–∞–ø—É—Å–∫ ---
        
        document.querySelectorAll('.pickaxe-button').forEach(button => {
            button.addEventListener('click', () => {
                if (activePickaxe) {
                    messageElement.textContent = 'üõë –î–æ–∂–¥–∏—Ç–µ—Å—å, –ø–æ–∫–∞ –∫–∏—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç –±—Ä–æ—Å–æ–∫!';
                    return;
                }
                
                const price = parseInt(button.dataset.price);
                const type = button.dataset.type;
                
                if (playerBalance >= price) {
                    playerBalance -= price;
                    balanceElement.textContent = playerBalance;
                    
                    activePickaxe = new Pickaxe(type);
                    messageElement.textContent = `üöÄ ${PICKAXE_PROPERTIES[type].name} –∑–∞–ø—É—â–µ–Ω–∞!`;
                } else {
                    messageElement.textContent = `üö´ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ (${price - playerBalance} –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç).`;
                }
            });
        });
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
        balanceElement.textContent = playerBalance;
        
        // –ó–∞–ø—É—Å–∫
        generateInitialArena(EMPTY_START_ROWS, INITIAL_MINING_ROWS); 
        requestAnimationFrame(gameLoop); 
    </script>
</body>
</html>
