<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Slot Physics</title>
    <style>
        :root {
            --cell-size: 60px;
            --grid-cols: 5;
            --mc-bg: #404040;
            --mc-border: #1e1e1e;
        }

        body {
            background-color: #1a1a1a;
            color: white;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        #game-wrapper {
            width: calc(var(--cell-size) * var(--grid-cols) + 40px);
            background: #8b8b8b;
            border: 6px solid #373737;
            padding: 10px;
            box-shadow: inset -4px -4px 0 #555, inset 4px 4px 0 #fff;
        }

        /* –ü–æ–ª–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ 3x5 */
        #tool-grid {
            display: grid;
            grid-template-columns: repeat(var(--grid-cols), var(--cell-size));
            grid-template-rows: repeat(3, var(--cell-size));
            gap: 2px;
            background: #373737;
            border: 4px solid #1e1e1e;
            margin-bottom: 20px;
        }

        .tool-slot {
            background: #8b8b8b;
            border: 2px solid #373737;
            box-shadow: inset -2px -2px 0 #555;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            transition: all 0.2s;
        }

        .tool-slot.active {
            background: #fff;
            transform: scale(1.1);
        }

        /* –ü–æ–ª–µ –±–ª–æ–∫–æ–≤ */
        #world-container {
            position: relative;
            width: calc(var(--cell-size) * var(--grid-cols));
            height: calc(var(--cell-size) * 5);
            background: rgba(0,0,0,0.3);
            border: 4px solid #1e1e1e;
            overflow: hidden;
        }

        .block {
            position: absolute;
            width: var(--cell-size);
            height: var(--cell-size);
            box-sizing: border-box;
            border: 2px solid rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.2s;
            text-shadow: 1px 1px 0 #000;
        }

        /* –¢–∏–ø—ã –±–ª–æ–∫–æ–≤ */
        .stone { background: #7a7a7a; border-bottom: 4px solid #4a4a4a; }
        .ore { background: #555; border: 3px solid #00ffcc; color: #00ffcc; }
        .gold { background: #666; border: 3px solid #ffd700; color: #ffd700; }
        .chest { background: #8b4513; border: 3px solid #3e2723; color: #ffa500; z-index: 2; }

        /* –ö–Ω–æ–ø–∫–∞ */
        #spin-btn {
            width: 100%;
            margin-top: 15px;
            padding: 15px;
            background: #5c9e31;
            border: none;
            border-bottom: 5px solid #3a631f;
            color: white;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            text-shadow: 1px 1px 0 #222;
        }

        #spin-btn:active {
            transform: translateY(3px);
            border-bottom-width: 2px;
        }

        #spin-btn:disabled {
            background: #444;
            border-color: #222;
            cursor: not-allowed;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div id="game-wrapper">
    <div id="tool-grid"></div>
    <div id="world-container"></div>
    
    <div class="stats">
        <span>–ú–û–ù–ï–¢–´: <span id="score">0</span></span>
        <span>–ë–û–ù–£–°: <span id="multiplier">x1</span></span>
    </div>
    
    <button id="spin-btn" onclick="playTurn()">–ò–ì–†–ê–¢–¨ (–°–ü–ò–ù)</button>
</div>

<script>
    const toolGrid = document.getElementById('tool-grid');
    const world = document.getElementById('world-container');
    const scoreEl = document.getElementById('score');
    const spinBtn = document.getElementById('spin-btn');

    const COLS = 5;
    const ROWS = 5;
    const SIZE = 60;
    let score = 0;
    let grid = Array.from({ length: COLS }, () => []);

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
    for (let i = 0; i < 15; i++) {
        const slot = document.createElement('div');
        slot.className = 'tool-slot';
        slot.id = `slot-${i}`;
        toolGrid.appendChild(slot);
    }

    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏—Ä–∞ –±–ª–æ–∫–∞–º–∏
    function initWorld() {
        for (let c = 0; c < COLS; c++) {
            for (let r = 0; r < ROWS; r++) {
                spawnBlock(c, r);
            }
        }
    }

    function spawnBlock(col, row, isNew = false) {
        const types = ['stone', 'stone', 'stone', 'ore', 'gold', 'chest'];
        const type = types[Math.floor(Math.random() * types.length)];
        const el = document.createElement('div');
        el.className = `block ${type}`;
        el.style.left = `${col * SIZE}px`;
        el.style.top = isNew ? `-${SIZE}px` : `${row * SIZE}px`;
        
        const blockObj = { type, el, col };
        world.appendChild(el);
        grid[col][row] = blockObj;

        if(isNew) {
            setTimeout(() => { el.style.top = `${row * SIZE}px`; }, 50);
        }
    }

    async function playTurn() {
        spinBtn.disabled = true;
        
        // 1. –ê–Ω–∏–º–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (3 —Ä—è–¥–∞ x 5 –∫–æ–ª–æ–Ω–æ–∫)
        const tools = ['‚õèÔ∏è', '‚õèÔ∏è', 'üí£', '‚öîÔ∏è', ''];
        let results = [];
        for (let i = 0; i < 15; i++) {
            const res = Math.random() > 0.6 ? tools[Math.floor(Math.random() * tools.length)] : '';
            results.push(res);
            document.getElementById(`slot-${i}`).innerText = res;
        }

        // 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ —Ä—è–¥–∞–º (—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)
        for (let r = 0; r < 3; r++) {
            for (let c = 0; c < 5; c++) {
                const tool = results[r * 5 + c];
                const slot = document.getElementById(`slot-${r * 5 + c}`);
                
                if (tool) {
                    slot.classList.add('active');
                    await applyTool(tool, c);
                    await new Promise(res => setTimeout(res, 150));
                    slot.classList.remove('active');
                }
            }
        }

        spinBtn.disabled = false;
    }

    async function applyTool(tool, col) {
        if (tool === '‚õèÔ∏è') {
            await destroyTopBlock(col);
        } else if (tool === 'üí£') {
            for(let i=0; i<3; i++) await destroyTopBlock(col);
        } else if (tool === '‚öîÔ∏è') {
            while(grid[col].length > 0) await destroyTopBlock(col);
        }
        updatePhysics();
    }

    function destroyTopBlock(col) {
        return new Promise(resolve => {
            if (grid[col].length === 0) return resolve();
            
            const block = grid[col].shift(); // –ó–∞–±–∏—Ä–∞–µ–º –≤–µ—Ä—Ö–Ω–∏–π
            block.el.style.transform = 'scale(1.2)';
            block.el.style.opacity = '0';
            
            // –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤
            if (block.type === 'chest') score += 500;
            else if (block.type === 'gold') score += 100;
            else if (block.type === 'ore') score += 50;
            else score += 10;
            
            scoreEl.innerText = score;

            setTimeout(() => {
                block.el.remove();
                resolve();
            }, 100);
        });
    }

    function updatePhysics() {
        for (let c = 0; c < COLS; c++) {
            // –û–ø—É—Å–∫–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±–ª–æ–∫–∏
            grid[c].forEach((block, index) => {
                block.el.style.top = `${index * SIZE}px`;
            });
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É, –µ—Å–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
            while (grid[c].length < ROWS) {
                spawnBlock(c, grid[c].length, true);
            }
        }
    }

    initWorld();
</script>

</body>
</html>